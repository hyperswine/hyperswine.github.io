<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-research/latency-sensitive-design">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Latency Sensitive Design | Jasen Qin</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://n.project-spectre.info/docs/research/latency-sensitive-design"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Latency Sensitive Design | Jasen Qin"><meta data-rh="true" name="description" content="By Jasen Qin."><meta data-rh="true" property="og:description" content="By Jasen Qin."><link data-rh="true" rel="icon" href="/img/Rei-Light.png"><link data-rh="true" rel="canonical" href="https://n.project-spectre.info/docs/research/latency-sensitive-design"><link data-rh="true" rel="alternate" href="https://n.project-spectre.info/docs/research/latency-sensitive-design" hreflang="en"><link data-rh="true" rel="alternate" href="https://n.project-spectre.info/docs/research/latency-sensitive-design" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Jasen Qin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Jasen Qin Atom Feed">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.ec02ea49.css">
<link rel="preload" href="/assets/js/runtime~main.795a2e53.js" as="script">
<link rel="preload" href="/assets/js/main.d792f1f5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Overview</b></a><a class="navbar__item navbar__link" href="/blog">Posts</a><a class="navbar__item navbar__link" href="/docs/base/spectre-system">Works</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/research/dynamic-design-theory">Research</a><a class="navbar__item navbar__link" href="/docs/about/resume">About</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hyperswine/projects" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/research/dynamic-design-theory">Dynamic Design Theory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/research/latency-sensitive-design">Latency Sensitive Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/research/kernels-and-utility">Enlightened Kernel Architecture: Utility, Security, and Performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/research/isa-pt1">Instruction Set Architecture from First Principles: Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/research/performance-post">Performance Considerations, Pt. 1</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Latency Sensitive Design</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Latency Sensitive Design</h1><p><strong>By Jasen Qin.</strong></p><p>LSD is a science of software design that attempts to formalise the idea of latency in program specifications.</p><p>LSD deals with information and byte flux at the register level to the function level. What LSD allows us to do is reduce and model a hardware + software environment in a flow centric manner, observing bottlenecks and optimising the software intent in a constrained environment, e.g. subject to battery usage and heat generation.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="precursors">Precursors<a class="hash-link" href="#precursors" title="Direct link to heading">​</a></h2><p><strong>Algorithmic complexity</strong> ⇒ Applicable to anything reducible to a formal algorithm. Big O Notation, constant, linear, logarithmic, exponential. A high level overview of an algorithm’s mathematical behavior in a vacuum. Unfortunately does not capture the underlying systems that tries to emulate/execute a specification.</p><p><strong>Queuing theory</strong> ⇒ Erlang related, exactly like what it sounds like. The science of queues and waiting in line.</p><p><strong>Traffic theory</strong> ⇒ Flow and density of traffic. Flux.</p><p><strong>Tools</strong> ⇒ profiling tools like criterion, flamegraphs, unix <code>time</code>, and possibly more I don’t know about.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="littles-law">Little’s Law<a class="hash-link" href="#littles-law" title="Direct link to heading">​</a></h2><p>Given a queue system in a stable state: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>avg. requests</mtext><mo>=</mo><mtext>avg. arrival rate</mtext><mo>×</mo><mtext>avg. time spent</mtext></mrow><annotation encoding="application/x-tex">\text{avg. requests} = \text{avg. arrival rate} \times \text{avg. time spent}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">avg. requests</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">avg. arrival rate</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">avg. time spent</span></span></span></span></span></span>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="amdahls-law">Amdahl’s Law<a class="hash-link" href="#amdahls-law" title="Direct link to heading">​</a></h2><p>Amdahl’s Law is concerned with parallelisation and response times.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="traffic-models">Traffic Models<a class="hash-link" href="#traffic-models" title="Direct link to heading">​</a></h2><p>A traffic model describes traffic flow in terms of individual actors or a continuous flux of information in a system. The system itself can be seen as a digraph where the edges represent the congestion index.</p><p>If you want to model car crashes and accidents, then you would want to use a microscopic model. If you want to zoom out and observe the general flow of information from point A and point B through continuous statistical measures like averages and std devs, you’d want to use a macroscopic model.</p><p>The thing with bytes and registers is that it is very useful to use a macroscopic model rather than considering each byte transfer individually, although that is still quite useful.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="three-phase-traffic-theory">Three Phase Traffic Theory<a class="hash-link" href="#three-phase-traffic-theory" title="Direct link to heading">​</a></h2><p>A theory of traffic flow invented by Boris K. Congestion can be divide into 2 states: synchronised flow and wide moving jam. Otherwise we have a free flow state.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="queuing-theory">Queuing Theory<a class="hash-link" href="#queuing-theory" title="Direct link to heading">​</a></h2><p>Invented by Agner Erlang. Also invented telephone traffic engineering (all of it I think?).</p><p>What does it mean to queue or line up? Basically:</p><ol><li>Arrival of data</li><li>Servicing according policy (e.g. FIFO)</li><li>Output of data</li></ol><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="axioms">Axioms<a class="hash-link" href="#axioms" title="Direct link to heading">​</a></h2><p>As a formal science, LSD aims to be rigorous.</p><ol><li>Flux</li><li>Density</li></ol><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="profiling-tools">Profiling Tools<a class="hash-link" href="#profiling-tools" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="flame-graphs">Flame Graphs<a class="hash-link" href="#flame-graphs" title="Direct link to heading">​</a></h3><p>Flame graphs were invented by Brendan G. and are a great way to visualise fn calls of a program. What you do is insert probes for each function so that each time a fn is called, the time it takes to execute is recorded and summed up, resulting in a mountain chart.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="perf">Perf<a class="hash-link" href="#perf" title="Direct link to heading">​</a></h3><p>Perf is a pretty legit and complete linux profiler that records a bunch of different information and is configurable to get what you are looking for. CPU performance, tracepoints, kprobes (kernel probes), uprobes (user probes).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-to-profile">What to Profile?<a class="hash-link" href="#what-to-profile" title="Direct link to heading">​</a></h2><p>In a modern von neumann computer, we have a CPU, a bunch of memory, accelerator units, ports and peripherals attached to them. What is hard to control is networking, but I think we  can prioritise it. Copying data across disks and devices as well… illusions are probably key, keep the data in memory and pretend that its copied to the device but know that its actually not copied yet.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cpu">CPU<a class="hash-link" href="#cpu" title="Direct link to heading">​</a></h3><p>When profiling the CPU, we are mostly looking for an overall %usage metric and perhaps any anomalies in cpu usage over time. E.g. any large spikes or dips may indicate some program or scheduling problem or worse, a hardware problem.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="heat">Heat<a class="hash-link" href="#heat" title="Direct link to heading">​</a></h3><p>We may also be interested in external statistics such as temperature and rate of temperature increase/decrease since they may cause indirect problems with performance, e.g. conductivity-heat relationships with the components. The higher the temperature the more the component would probably have to throttle to not become damaged from prolonged heat stress and inefficiencies due to lower conductivity.</p><p>Silicon actually has a pretty high melting point of 1410degC. Copper melts at 1000degC. So your components shouldn’t just start melting anytime soon, and 100degC is quite far. But the heat can seem to cause lattice deformations and damages to small scale features.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/research/dynamic-design-theory"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Dynamic Design Theory</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/research/kernels-and-utility"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Enlightened Kernel Architecture: Utility, Security, and Performance</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#precursors" class="table-of-contents__link toc-highlight">Precursors</a></li><li><a href="#littles-law" class="table-of-contents__link toc-highlight">Little’s Law</a></li><li><a href="#amdahls-law" class="table-of-contents__link toc-highlight">Amdahl’s Law</a></li><li><a href="#traffic-models" class="table-of-contents__link toc-highlight">Traffic Models</a></li><li><a href="#three-phase-traffic-theory" class="table-of-contents__link toc-highlight">Three Phase Traffic Theory</a></li><li><a href="#queuing-theory" class="table-of-contents__link toc-highlight">Queuing Theory</a></li><li><a href="#axioms" class="table-of-contents__link toc-highlight">Axioms</a></li><li><a href="#profiling-tools" class="table-of-contents__link toc-highlight">Profiling Tools</a><ul><li><a href="#flame-graphs" class="table-of-contents__link toc-highlight">Flame Graphs</a></li><li><a href="#perf" class="table-of-contents__link toc-highlight">Perf</a></li></ul></li><li><a href="#what-to-profile" class="table-of-contents__link toc-highlight">What to Profile?</a><ul><li><a href="#cpu" class="table-of-contents__link toc-highlight">CPU</a></li><li><a href="#heat" class="table-of-contents__link toc-highlight">Heat</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.795a2e53.js"></script>
<script src="/assets/js/main.d792f1f5.js"></script>
</body>
</html>